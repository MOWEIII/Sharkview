<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:AutoRenderer.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="AutoRenderer.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">
    
    <ScrollViewer>
        <StackPanel Margin="30" Spacing="25" MaxWidth="800" HorizontalAlignment="Left">
            
            <TextBlock Text="Settings" FontSize="28" FontWeight="Bold"/>
            
            <!-- General Settings -->
            <StackPanel Spacing="10">
                <TextBlock Text="GENERAL" FontSize="12" FontWeight="Bold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                
                <Border Classes="Card">
                    <StackPanel Spacing="20">
                        <!-- Blender Path -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Blender Executable Path" FontWeight="Medium"/>
                            <Grid ColumnDefinitions="*, 10, Auto, 10, Auto">
                                <TextBox Grid.Column="0" Text="{Binding BlenderPath}" Watermark="C:\Program Files\Blender Foundation\Blender 4.0\blender.exe"/>
                                <Button Grid.Column="2" Content="Browse" Command="{Binding BrowseBlenderPathCommand}"/>
                                <Button Grid.Column="4" Content="Auto Detect" Command="{Binding AutoDetectBlenderCommand}"/>
                            </Grid>
                        </StackPanel>

                        <Separator Background="{DynamicResource BorderBrush}" Height="1"/>

                        <!-- Output Path -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Default Output Directory" FontWeight="Medium"/>
                            <Grid ColumnDefinitions="*, 10, Auto">
                                <TextBox Grid.Column="0" Text="{Binding DefaultOutputPath}" Watermark="Select a folder..."/>
                                <Button Grid.Column="2" Content="Browse" Command="{Binding BrowseOutputPathCommand}"/>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Video Output Settings -->
            <StackPanel Spacing="10">
                <TextBlock Text="VIDEO OUTPUT" FontSize="12" FontWeight="Bold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                
                <Border Classes="Card">
                    <StackPanel Spacing="20">
                        <!-- Resolution & FPS -->
                        <Grid ColumnDefinitions="*, 20, *">
                             <StackPanel Grid.Column="0" Spacing="8">
                                <TextBlock Text="Resolution Preset" FontWeight="Medium"/>
                                <ComboBox ItemsSource="{Binding AvailableResolutions}" SelectedItem="{Binding SelectedResolutionPreset}" HorizontalAlignment="Stretch"/>
                             </StackPanel>
                             
                             <Grid Grid.Column="2" ColumnDefinitions="*, 10, *">
                                 <StackPanel Grid.Column="0" Spacing="8">
                                    <TextBlock Text="Width" FontWeight="Medium"/>
                                    <NumericUpDown Value="{Binding ResolutionWidth}" Minimum="1" Maximum="7680" FormatString="F0"/>
                                 </StackPanel>
                                 <StackPanel Grid.Column="2" Spacing="8">
                                    <TextBlock Text="Height" FontWeight="Medium"/>
                                    <NumericUpDown Value="{Binding ResolutionHeight}" Minimum="1" Maximum="4320" FormatString="F0"/>
                                 </StackPanel>
                             </Grid>
                        </Grid>
                        
                        <Grid ColumnDefinitions="*, 20, *">
                             <StackPanel Grid.Column="0" Spacing="8">
                                <TextBlock Text="Frame Rate (FPS)" FontWeight="Medium"/>
                                <ComboBox ItemsSource="{Binding AvailableFrameRates}" SelectedItem="{Binding FrameRate}" HorizontalAlignment="Stretch"/>
                             </StackPanel>
                             <StackPanel Grid.Column="2" Spacing="8">
                                <TextBlock Text="Codec" FontWeight="Medium"/>
                                <ComboBox ItemsSource="{Binding AvailableCodecs}" SelectedItem="{Binding Codec}" HorizontalAlignment="Stretch"/>
                             </StackPanel>
                        </Grid>

                        <StackPanel Spacing="8">
                             <TextBlock Text="Render Engine" FontWeight="Medium"/>
                             <ComboBox ItemsSource="{Binding AvailableRenderEngines}" SelectedItem="{Binding RenderEngine}" HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <!-- Advanced Encoding -->
                        <Expander Header="Advanced Encoding" IsExpanded="False" HorizontalAlignment="Stretch" BorderThickness="0" Background="Transparent">
                            <StackPanel Spacing="15" Margin="0,10,0,0">
                                <Grid ColumnDefinitions="*, 20, *, 20, *">
                                    <StackPanel Grid.Column="0" Spacing="8">
                                        <TextBlock Text="Bitrate Mode" FontWeight="Medium"/>
                                        <ComboBox ItemsSource="{Binding AvailableBitrateModes}" SelectedItem="{Binding BitrateMode}" HorizontalAlignment="Stretch"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Spacing="8">
                                        <TextBlock Text="Bitrate (Kbps)" FontWeight="Medium"/>
                                        <NumericUpDown Value="{Binding BitrateKbps}" Minimum="100" Maximum="100000" FormatString="F0"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="4" Spacing="8">
                                        <TextBlock Text="GOP Size" FontWeight="Medium"/>
                                        <NumericUpDown Value="{Binding GopSize}" Minimum="1" Maximum="300" FormatString="F0"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Default Render Settings -->
            <StackPanel Spacing="10">
                <TextBlock Text="DEFAULTS" FontSize="12" FontWeight="Bold" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                
                <Border Classes="Card">
                    <Grid ColumnDefinitions="*, 20, *, 20, *">
                        <StackPanel Grid.Column="0" Spacing="8">
                            <TextBlock Text="Output Filename Prefix" FontWeight="Medium"/>
                            <TextBox Text="{Binding OutputFileName}"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="8">
                            <TextBlock Text="Duration (Seconds)" FontWeight="Medium"/>
                            <NumericUpDown Value="{Binding Duration}" Minimum="0.1" Maximum="3600"/>
                        </StackPanel>
                        <StackPanel Grid.Column="4" Spacing="8">
                            <TextBlock Text="Format" FontWeight="Medium"/>
                            <ComboBox ItemsSource="{Binding AvailableFormats}" SelectedItem="{Binding SelectedFormat}" HorizontalAlignment="Stretch"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </StackPanel>

            <!-- Actions -->
            <StackPanel Spacing="10" HorizontalAlignment="Left" Margin="0,20,0,0">
                <Button Content="Save All Settings" Command="{Binding SaveSettingsCommand}" Classes="Primary" Width="200" Height="40" FontSize="14"/>
                <TextBlock Text="{Binding StatusMessage}" Foreground="{DynamicResource AccentColor}" HorizontalAlignment="Center"/>
            </StackPanel>
            
        </StackPanel>
    </ScrollViewer>
</UserControl>