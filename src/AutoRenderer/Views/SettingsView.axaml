<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:AutoRenderer.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="AutoRenderer.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">
    
    <StackPanel Margin="20" Spacing="20">
        <TextBlock Text="Settings" FontSize="24" FontWeight="Bold"/>
        
        <!-- Blender Path -->
        <StackPanel Spacing="10">
            <TextBlock Text="Blender Executable Path" FontWeight="SemiBold"/>
            <Grid ColumnDefinitions="*, Auto, Auto">
                <TextBox Grid.Column="0" Text="{Binding BlenderPath}" Watermark="Path to blender.exe"/>
                <Button Grid.Column="1" Content="Browse" Command="{Binding BrowseBlenderPathCommand}" Margin="10,0,0,0"/>
                <Button Grid.Column="2" Content="Auto Detect" Command="{Binding AutoDetectBlenderCommand}" Margin="10,0,0,0"/>
            </Grid>
        </StackPanel>

        <!-- Output Path -->
        <StackPanel Spacing="10">
            <TextBlock Text="Default Output Directory" FontWeight="SemiBold"/>
            <Grid ColumnDefinitions="*, Auto">
                <TextBox Grid.Column="0" Text="{Binding DefaultOutputPath}" Watermark="Path to output directory"/>
                <Button Grid.Column="1" Content="Browse" Command="{Binding BrowseOutputPathCommand}" Margin="10,0,0,0"/>
            </Grid>
        </StackPanel>

        <!-- Video Output Settings -->
        <StackPanel Spacing="10">
            <TextBlock Text="Video Output Settings" FontWeight="SemiBold"/>
            <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="4" Padding="10">
                <StackPanel Spacing="10">
                    <!-- Resolution & FPS -->
                    <Grid ColumnDefinitions="*, *, *">
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="Resolution Preset"/>
                            <ComboBox ItemsSource="{Binding AvailableResolutions}" SelectedItem="{Binding SelectedResolutionPreset}" HorizontalAlignment="Stretch"/>
                        </StackPanel>
                        <StackPanel Grid.Column="1" Margin="0,0,10,0">
                            <TextBlock Text="Width"/>
                            <NumericUpDown Value="{Binding ResolutionWidth}" Minimum="1" Maximum="7680" FormatString="F0"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Height"/>
                            <NumericUpDown Value="{Binding ResolutionHeight}" Minimum="1" Maximum="4320" FormatString="F0"/>
                        </StackPanel>
                    </Grid>
                    
                    <Grid ColumnDefinitions="*, *">
                         <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="Frame Rate (FPS)"/>
                            <ComboBox ItemsSource="{Binding AvailableFrameRates}" SelectedItem="{Binding FrameRate}" HorizontalAlignment="Stretch"/>
                         </StackPanel>
                         <StackPanel Grid.Column="1">
                            <TextBlock Text="Codec"/>
                            <ComboBox ItemsSource="{Binding AvailableCodecs}" SelectedItem="{Binding Codec}" HorizontalAlignment="Stretch"/>
                         </StackPanel>
                    </Grid>

                    <!-- Bitrate & GOP -->
                    <Grid ColumnDefinitions="*, *, *">
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="Bitrate Mode"/>
                            <ComboBox ItemsSource="{Binding AvailableBitrateModes}" SelectedItem="{Binding BitrateMode}" HorizontalAlignment="Stretch"/>
                        </StackPanel>
                        <StackPanel Grid.Column="1" Margin="0,0,10,0">
                            <TextBlock Text="Bitrate (Kbps)"/>
                            <NumericUpDown Value="{Binding BitrateKbps}" Minimum="100" Maximum="100000" FormatString="F0"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="GOP Size"/>
                            <NumericUpDown Value="{Binding GopSize}" Minimum="1" Maximum="300" FormatString="F0"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
        </StackPanel>

        <Button Content="Save Settings" Command="{Binding SaveSettingsCommand}" HorizontalAlignment="Center"/>
        
        <TextBlock Text="{Binding StatusMessage}" Foreground="Gray" FontStyle="Italic"/>
    </StackPanel>
</UserControl>
